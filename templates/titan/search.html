{% extends 'base.html'%}
{%block content%}

<h1>Search drugs & Prescribers</h1>




<p> {{test}} </p>
{{resultset}} 

<p> {{form}} </p>

{% for x in resultset%}

{{x.fname}}

{% endfor %}


<div class="container">


 
    <div class="d-flex justify-content-center" style="width: 80%;">

        <div class="d-flex justify-content-center align-items-center" style="background-color: lightgray; padding: 1rem; margin: auto; border-radius: 1rem; width: 40rem;">
            <h2>I'm looking for a... </h2>
            <div class="d-flex justify-content-center" >
                <label for="searchparam">Prescriber</label>
                  <input class="" style="height: 2rem; width: 2rem; margin-left: 2rem;" id="prescriberradio" type="radio" id="prescriberradio" value="prescriber" name="searchparam" onclick="switchforms();" checked > 
            </div>
            <div class="d-flex justify-content-center">
                <label for="searchparam">Drug</label>
                 <input class="" style="height: 2rem; width: 2rem; margin-left: 2rem;"  type="radio" id="drugradio" value="drug" name="searchparam" onclick="switchforms();" >
            </div>
        </div>


        <div class="d-flex" style="background-color:#f44336!important; padding: 2rem; border-radius: 1rem; margin: auto; margin-top: 2rem; width: 60rem; " id="prescriberform">
            <form name="prescriberform" action="{% url 'search' %}" method="get">
                <div class="d-flex justify-content-center" >

                    <h2>Prescriber Details </h2>
                    <h5> <i> All fields are optional</i> </h5>

                    <div class="d-flex">
                        <h3 for="firstname">First Name</h3>
                        <input class="form-control" type="text" placeholder="First Name" name="firstname" >
                
                    </div>
                    

                    <div class="d-flex flex-column">
                        <h3 for="lastname">Last name</h3>
                        <input class="form-control" type="text" placeholder="Last Name" name="lastname" >
                    </div>


                    {% comment %} FIX ME: NEEDS TO BE DYNAMIC {% endcomment %}
                    <div>
                        <h3 for="state">State</h3>
                        <select class="form-control" name="state" id="state">
                            <option value="" selected>Any</option>
                            <option value="UT">Utah</option>
                            <option value="TX">Texas</option>
                            <option value="NY">New York</option>
                            <option value="YEET">yadda</option>
                        </select>

                    </div>


                    {% comment %} FIX ME: NEEDS TO BE DYNAMIC {% endcomment %}
                    <div>
                        <h3 for="credential">Credentials</h3>
                        <select class="form-control" name="credential" id="credential">
                            <option value="" selected>Any</option>
                            <option value="MD">Doctor</option>
                            <option value="NP">Nurse Practioner</option>
                            <option value="CNP">Certified Nurse Practioner</option>
                            <option value="AN">Analthesiologst</option>
                        </select>

                    </div>

                    <div class="d-flex flex-row">
                        <h3>Gender</h3>
                        <input style="height: 2.5rem; width: 2.5rem;" type="radio" id="male" value="M" name="gender" >
                        <label for="gender">Male</label>
                        
                        <input style="height: 2.5rem; width: 2.5rem; margin-left: 2rem;" type="radio" id="female" value="F" name="gender" >
                        <label for="gender">Female</label>
                        
                        <input style="height: 2.5rem; width: 2.5rem; margin-left: 1rem;" type="radio" id="blank" value="" name="gender" checked >
                        <label for="gender">Any</label>
                        

                    </div>

                    

                    <button type="submit" style="margin-left: 45%; margin-top: 1.5rem;" name="prescriberform" class="btn ">Submit!</button>
                </div>
            </form>
        </div>


        <div id="drugform" style="background-color:#f44336!important; padding: 2rem; border-radius: 1rem; margin: auto; margin-top: 2rem; width: 60rem; display: none; ">
            <form class="d-flex justify-content-center" action="" method="get">
                <h2>Drug Details </h2>
                <div class="d-flex flex-column">
                    <h3 for="medicationname">Medication Name</h3>
                    <input class="form-control" type="text" placeholder="Medication Name" name="medicationname" >
                </div>

                <div class="d-flex flex-row">
                        <h3>Opioid</h3>
                        <input style="height: 2.5rem; width: 2.5rem;" type="radio" id="male" value="t" name="isopioid" >
                        <label for="isopioid">Yes</label>
                        
                        <input style="height: 2.5rem; width: 2.5rem; margin-left: 2rem;" type="radio" id="female" value="f" name="isopioid" >
                        <label for="isopioid">No</label>
                        
                        <input style="height: 2.5rem; width: 2.5rem; margin-left: 1rem;" type="radio" id="blank" value="" name="isopioid" checked >
                        <label for="isopioid">Either</label>
                        
                    </div>   
                <button type="submit" style="margin-left: 45%; margin-top: 1.5rem;" name="drugform" class="btn">Submit!</button>
            </form>
        </div>
    
        <a class="btn btn-primary btn-xl text-uppercase js-scroll-trigger" href="{% url 'addprescriber'  %}">Add New Prescriber</a>
        {% comment %} No results found Block {% endcomment %}
        <div class="d-flex justify-content-center">
            {%if resultset|length == 0 and form == 'prescriberform' or form == 'drugform' %}
            <h2>No Results Found. Please Search Again</h2>

            {%endif%}

            {% comment %} IF prescriber (NOT DRUG!) then load this {% endcomment %}

            {%if resultset|length == 0 and form == 'prescriberform'%}
            <div class="d-flex justify-content-center">
                <h2>Would you like to add a prescriber?</h2>
                <a class="btn btn-primary btn-xl text-uppercase js-scroll-trigger" href="{% url 'addprescriber'  %}">Add New Prescriber</a>
            </div>

            {%endif%}

        </div>

        {%if form == 'drugform' and resultset|length != 0%}
        <!-- Drug Table -->
        <div style="padding: 1rem; border-radius: 1rem; margin: auto; margin-top: 1rem; width: 60rem;">

        <h2>Results</h2>

        <table class="table table-striped table-bordered table-hover  ">
            <thead>
               <tr>
                   <th>
                       Name
                   </th>
                   <th>
                    Opioid?
                   </th>
                   <th>
                       Details
                   </th>
               </tr>
            </thead>
            {% for result in resultset%}
            <tr onclick="">
                <td>Ibuprofen</td>
                <td>&#10003;</td>
                <td><a class="btn btn-primary btn-xl text-uppercase js-scroll-trigger" href="{% url 'detailsdrugs' drugid=1  %}">Show More</a></td>
            </tr>
            {% endfor %}
        </table>

         </div>
        
        {%endif%}

        {% comment %} Provider Table {% endcomment %}

        {%if form == 'prescriberform' and resultset|length != 0%}

        <div style="padding: 1rem; border-radius: 1rem; margin: auto; margin-top: 1rem; width: 60rem;">

            <h2>Results</h2>

         <table class="table table-striped table-bordered table-hover">
             <thead>
                <tr>
                    <th>
                        Specialty
                    </th>
                    <th>
                        Name
                    </th>
                    <th>
                        Details
                    </th>
                </tr>
             </thead>
             {% for result in resultset%}
             <tr>
                 <td>{{result.specialty}}</td>
                 <td>{{result.fname}} {{result.lname}}</td>
                 <td><a class="btn btn-primary btn-xl text-uppercase js-scroll-trigger" href="{% url 'details' prescriberid=result.npi  %}">Show More</a></td>
             </tr>
             {% endfor %}
             
         </table>

        </div>
         {%endif%}


         
    </div>
</div>
{% endblock%}